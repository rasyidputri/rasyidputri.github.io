(()=>{var U=(()=>{let i=null,c=null,f=0,r=0,l=!0,s=()=>{f+=1},m=()=>`(${r}/${f}) [${parseInt(r/f*100).toFixed(0)}%]`;return{init:()=>{i=document.getElementById("progress-info"),c=document.getElementById("progress-bar"),i.style.display="block"},add:s,invalid:A=>{l=!1,c.style.backgroundColor="red",i.innerText=`Error loading ${A} ${m()}`},complete:A=>{l&&(r+=1,i.innerText=`Loading ${A} complete ${m()}`,c.style.width=Math.min(r/f*100,100).toString()+"%",r===f&&document.dispatchEvent(new Event("progress.done")))}}})();var b=(()=>{let i='<span class="spinner-border spinner-border-sm my-0 ms-0 me-1 p-0" style="height: 0.8rem; width: 0.8rem;"></span>',c=a=>String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),f=(a,y,o=.05)=>new Promise(u=>{let v=parseFloat(a.style.opacity),T=y?1:0,w=()=>{v+=y?o:-o,v=Math.max(0,Math.min(1,v)),a.style.opacity=v.toFixed(2),y&&v>=T||!y&&v<=T?(a.style.opacity=T.toString(),u(a)):requestAnimationFrame(w)};requestAnimationFrame(w)}),r=(a,y)=>{let o=null;o=setTimeout(()=>{a(),clearTimeout(o),o=null},y)};return{loader:i,copy:async(a,y=null,o=1500)=>{let u=a.getAttribute("data-copy");if(!u||u.length===0){alert("Nothing to copy");return}a.disabled=!0;try{await navigator.clipboard.writeText(u)}catch{a.disabled=!1,alert("Failed to copy");return}let v=a.innerHTML;a.innerHTML=y||'<i class="fa-solid fa-check"></i>',r(()=>{a.disabled=!1,a.innerHTML=v},o)},timeOut:r,debounce:(a,y)=>{let o=null;return(...u)=>{clearTimeout(o),o=setTimeout(()=>a(...u),y)}},escapeHtml:c,base64Encode:a=>{let o=new TextEncoder().encode(a);return window.btoa(String.fromCharCode(...o))},base64Decode:a=>{let y=new TextDecoder,o=Uint8Array.from(window.atob(a),u=>u.charCodeAt(0));return y.decode(o)},disableButton:(a,y="Loading",o=!1)=>{a.disabled=!0;let u=a.innerHTML;return a.innerHTML=o?y:i+y,{restore:(v=!1)=>{a.innerHTML=u,a.disabled=v}}},disableCheckbox:a=>{a.disabled=!0;let y=document.querySelector(`label[for="${a.id}"]`),o=y.innerHTML;return y.innerHTML=i+o,{restore:()=>{y.innerHTML=o,a.disabled=!1}}},parseUserAgent:a=>{let y=[{type:"Mobile",regex:/Android.*Mobile|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i},{type:"Tablet",regex:/iPad|Android(?!.*Mobile)|Tablet/i},{type:"Desktop",regex:/Windows NT|Macintosh|Linux/i}],o=[{name:"Chrome",regex:/Chrome|CriOS/i},{name:"Safari",regex:/Safari/i},{name:"Edge",regex:/Edg|Edge/i},{name:"Firefox",regex:/Firefox|FxiOS/i},{name:"Opera",regex:/Opera|OPR/i},{name:"Internet Explorer",regex:/MSIE|Trident/i}],u=[{name:"Windows",regex:/Windows NT ([\d.]+)/i},{name:"MacOS",regex:/Mac OS X ([\d_]+)/i},{name:"Android",regex:/Android ([\d.]+)/i},{name:"iOS",regex:/OS ([\d_]+) like Mac OS X/i},{name:"Linux",regex:/Linux/i}],v=y.find(E=>E.regex.test(a))?.type||"Unknown",T=o.find(E=>E.regex.test(a))?.name||"Unknown",w=u.find(E=>E.regex.test(a)),B=w&&a.match(w.regex)?.[1]?.replace(/_/g,".")||"",I=w?w.name:"Unknown";return B=B?`${I} ${B}`:I,`${T} ${v} ${B}`},changeOpacity:f}})();var F=(()=>{let i=(o,u,v)=>({code:o,data:u,error:v}),c=(o=0)=>({love:o}),f=({uuid:o,own:u,name:v,presence:T,comment:w,created_at:B,is_admin:I,gif_url:E,ip:_,user_agent:e,comments:n,like:d})=>({uuid:o,own:u,name:v,presence:T,comment:w,created_at:B,is_admin:I??!1,gif_url:E,ip:_,user_agent:e,comments:n?.map(f)??[],like:c(d?.love??0)}),r=o=>o.map(f);return{uuidResponse:({uuid:o})=>({uuid:o}),baseResponse:i,tokenResponse:({token:o})=>({token:o}),statusResponse:({status:o})=>({status:o}),commentResponse:({name:o,presence:u,comment:v,is_admin:T,gif_url:w,created_at:B})=>({name:o,presence:u,comment:v,is_admin:T,gif_url:w,created_at:B}),likeCommentResponse:c,getCommentResponse:f,getCommentsResponse:r,getCommentsResponseV2:o=>({count:o.count,lists:r(o.lists)}),commentShowMore:(o,u=!1)=>({uuid:o,show:u}),postCommentRequest:(o,u,v,T,w)=>({id:o,name:u,presence:v,comment:T,gif_id:w}),postSessionRequest:(o,u)=>({email:o,password:u}),updateCommentRequest:(o,u,v)=>({presence:o,comment:u,gif_id:v})}})();var G="GET",ie="PUT",Q="POST",re="PATCH",le="DELETE",Y=200,ne=201,be=500,Z={Accept:"application/json","Content-Type":"application/json"},z=(i,c)=>{let f=new AbortController,r=document.body.getAttribute("data-url"),l={signal:f.signal,method:String(i).toUpperCase(),headers:new Headers(Z)};return window.addEventListener("offline",()=>f.abort()),window.addEventListener("popstate",()=>f.abort()),r&&r.slice(-1)==="/"&&(r=r.slice(0,-1)),{send(s=null){return fetch(r+c,l).then(m=>m.json().then(p=>{if(m.status>=be&&(p.message??p[0]))throw new Error(p.message??p[0]);if(p.error)throw new Error(p.error[0]);return s&&(p.data=s(p.data)),F.baseResponse(p.code,p.data,p.error)})).catch(m=>{if(m.name==="AbortError")return console.warn("Fetch abort:",m),m;throw alert(m),new Error(m)})},withCancel(s){return(async()=>(await s,f.abort()))(),this},default(s=null){return l.headers=new Headers(s??{}),fetch(c,l)},download(){return Object.keys(Z).forEach(s=>l.headers.delete(s)),fetch(r+c,l).then(s=>{if(s.status!==Y)return!1;let m=document.querySelector("a[download]");m&&document.body.removeChild(m);let p=s.headers.get("content-disposition")?.match(/filename="(.+)"/)?.[1]??"download.csv";return s.blob().then(k=>{let $=document.createElement("a"),A=window.URL.createObjectURL(k);return $.href=A,$.download=p,document.body.appendChild($),$.click(),document.body.removeChild($),window.URL.revokeObjectURL(A),!0})}).catch(s=>{if(s.name==="AbortError")return console.warn("Fetch abort:",s),s;throw alert(s),new Error(s)})},token(s){return s.split(".").length===3?(l.headers.append("Authorization","Bearer "+s),this):(l.headers.append("x-access-key",s),this)},body(s){return l.body=JSON.stringify(s),this}}};var ae=(()=>{let i=null,c=null,f=!1,r=1e3*60*60*6,l="images",s=async a=>{let y=a.getAttribute("data-src"),o="x-expiration-time",u="image/webp",v=new Image;if(v.onload=()=>{a.src=v.src,a.width=v.width,a.height=v.height,v.remove(),U.complete("image")},i.has(y)){v.src=i.get(y);return}let T=I=>new Promise((E,_)=>{let e=document.createElement("canvas");e.width=I.width,e.height=I.height,e.getContext("2d").drawImage(I,0,0);let n=d=>{d?E(d):_(new Error("Failed to convert image to WebP")),e.remove()};e.onerror=_,e.toBlob(n,u,.8)}),w=(I,E=3,_=1e3)=>z(G,y).default().then(e=>e.blob()).then(e=>window.createImageBitmap(e)).then(e=>T(e)).then(e=>{let n=new Headers;return n.set("Content-Type",u),n.set("Content-Length",String(e.size)),n.set(o,String(Date.now()+r)),I.put(y,new Response(e,{headers:n})).then(()=>e)}).catch(e=>{if(E<=0)throw e;return console.warn("Retrying fetch:"+y),new Promise((n,d)=>b.timeOut(()=>w(I,E-1,_+1e3).then(n,d),_))}),B=I=>I.match(y).then(E=>E?Date.now()<=parseInt(E.headers.get(o))?E.blob():I.delete(y).then(_=>_?w(I):E.blob()):w(I));await caches.open(l).then(I=>B(I)).then(I=>{v.src=URL.createObjectURL(I),i.set(y,v.src)}).catch(I=>{throw U.invalid("image"),I})},m=a=>{a.onerror=()=>U.invalid("image"),a.onload=()=>{a.width=a.naturalWidth,a.height=a.naturalHeight,U.complete("image")},a.complete&&a.naturalWidth!==0&&a.naturalHeight!==0?U.complete("image"):a.complete&&U.invalid("image")},p=()=>f,k=a=>{r=Number(a)},$=()=>{(async()=>{for(let a of c)if(a.hasAttribute("data-src"))try{await s(a)}catch{break}else m(a)})()};return{init:()=>(i=new Map,c=document.querySelectorAll("img"),c.forEach(U.add),f=Array.from(c).some(a=>a.hasAttribute("data-src")),{load:$,setTtl:k,hasDataSrc:p})}})();var oe=(()=>{let i=null,c=null,f=null,r=null,l=!1,s=1e3*60*60*6,m="audio",p="audio/mpeg",k="x-expiration-time",$='<i class="fa-solid fa-circle-pause spin-button"></i>',A='<i class="fa-solid fa-circle-play"></i>',a=async()=>{if(navigator.onLine){i.disabled=!0;try{await r,await c.play(),l=!0,i.disabled=!1,i.innerHTML=$}catch(w){l=!1,alert(w)}}},y=()=>{l=!1,c.pause(),i.innerHTML=A},o=(w,B=3,I=1e3)=>z(G,f).default().then(E=>E.blob()).then(E=>{let _=new Headers;return _.set("Content-Type",p),_.set("Content-Length",String(E.size)),_.set(k,String(Date.now()+s)),w.put(f,new Response(E,{headers:_})).then(()=>E)}).catch(E=>{if(B<=0)throw E;return console.warn("Retrying fetch:"+f),new Promise(_=>b.timeOut(()=>_(o(w,B-1,I+1e3)),I))}),u=()=>caches.open(m).then(w=>w.match(f).then(B=>B?Date.now()<=parseInt(B.headers.get(k))?B.blob():w.delete(f).then(I=>I?o(w):B.blob()):o(w))).then(w=>URL.createObjectURL(w));return{init:async()=>{i=document.getElementById("button-music"),f=i.getAttribute("data-url"),document.addEventListener("undangan.open",()=>{i.style.display="block"});try{c=new Audio(await u()),c.volume=1,c.loop=!0,c.muted=!1,c.currentTime=0,c.autoplay=!1,c.controls=!1,r=new Promise(w=>c.addEventListener("canplay",w)),U.complete("audio")}catch{U.invalid("audio")}i.addEventListener("offline",y),i.addEventListener("click",()=>l?y():a())},play:a,setTtl:w=>{s=Number(w)}}})();var ce={tab:f=>window.bootstrap.Tab.getOrCreateInstance(document.getElementById(f)),modal:f=>window.bootstrap.Modal.getOrCreateInstance(document.getElementById(f))};var H=i=>{let c=(m=null)=>{let p=JSON.parse(localStorage.getItem(i));return m?p[String(m)]:p},f=(m,p)=>{let k=c();k[String(m)]=p,localStorage.setItem(i,JSON.stringify(k))},r=m=>Object.keys(c()).includes(String(m)),l=m=>{if(!r(m))return;let p=c();delete p[String(m)],localStorage.setItem(i,JSON.stringify(p))},s=()=>localStorage.setItem(i,"{}");return localStorage.getItem(i)||s(),{set:f,get:c,has:r,clear:s,unset:l}};var te=(()=>{let i={"#000000":"#ffffff","#ffffff":"#000000","#212529":"#f8f9fa","#f8f9fa":"#212529"},c=["#ffffff","#f8f9fa"],f=["#000000","#212529"],r=!1,l=null,s=null,m=()=>l.set("active","light"),p=()=>l.set("active","dark"),k=T=>{let w=s.getAttribute("content");s.setAttribute("content",T.some(B=>B===w)?i[w]:w)},$=()=>{m(),document.documentElement.setAttribute("data-bs-theme","light"),k(f)},A=()=>{p(),document.documentElement.setAttribute("data-bs-theme","dark"),k(c)},a=(T=null,w=null)=>{let B=l.get("active")==="dark";return T&&w?B?T:w:B};return{init:()=>{switch(l=H("theme"),s=document.querySelector('meta[name="theme-color"]'),l.has("active")||(window.matchMedia("(prefers-color-scheme: dark)").matches?p():m()),document.documentElement.getAttribute("data-bs-theme")){case"dark":p();break;case"light":m();break;default:r=!0}a()?A():$()},spyTop:()=>{let T=B=>B.filter(I=>I.isIntersecting).forEach(I=>{let E=I.target.classList.contains("bg-white-black")?a(f[0],c[0]):a(f[1],c[1]);s.setAttribute("content",E)}),w=new IntersectionObserver(T,{rootMargin:"0% 0% -95% 0%"});document.querySelectorAll("section").forEach(B=>w.observe(B))},change:()=>a()?$():A(),isDarkMode:a,isAutoMode:()=>r}})();var X=(()=>{let i={id:"ID",en:"US",fr:"FR",de:"DE",es:"ES",zh:"CN",ja:"JP",ko:"KR",ar:"SA",ru:"RU",it:"IT",nl:"NL",pt:"PT",tr:"TR",th:"TH",vi:"VN",ms:"MY",hi:"IN"},c=null,f=null,r=null,l=null;return{on(s,m){return l.set(s,m),this},get(){let s=l.get(r);return l.clear(),s},getCountry(){return c},getLocale(){return f},getLanguage(){return r},setDefault(s){let m=!0;i[s]||(m=!1,console.warn("Language not found, please add manually in countryMapping")),c=m?i[s]:"US",r=m?s:"en",f=`${r}_${c}`},init(){l=new Map,this.setDefault(navigator.language)}}})();var P=(()=>{let i=null,c=()=>i.get("token"),f=$=>i.set("token",$),r=$=>z(Q,"/api/session").body($).send(F.tokenResponse).then(A=>(A.code===Y&&f(A.data.token),A.code===Y),()=>!1),l=()=>i.unset("token"),s=()=>String(c()??".").split(".").length===3;return{init:()=>{i=H("session")},guest:()=>z(G,"/api/config").token(c()).send().then($=>{if($.code!==Y)throw new Error("failed to get config.");let A=H("config");for(let[a,y]of Object.entries($.data))A.set(a,y);return $}),login:r,logout:l,decode:()=>{if(!s())return null;try{return JSON.parse(window.atob(c().split(".")[1]))}catch{return null}},isAdmin:s,setToken:f,getToken:c}})();var de=(()=>{let i=null,c=!0,f=["input[data-offline-disabled]","button[data-offline-disabled]","select[data-offline-disabled]","textarea[data-offline-disabled]"],r=()=>c,l=()=>{let a=i.firstElementChild.firstElementChild;a.classList.remove("bg-success"),a.classList.add("bg-danger"),a.firstElementChild.innerHTML='<i class="fa-solid fa-ban me-2"></i>Koneksi tidak tersedia'},s=()=>{let a=i.firstElementChild.firstElementChild;a.classList.remove("bg-danger"),a.classList.add("bg-success"),a.firstElementChild.innerHTML='<i class="fa-solid fa-cloud me-2"></i>Koneksi tersedia kembali'},m=async()=>{c&&(await b.changeOpacity(i,!1),l())},p=()=>{document.querySelectorAll(f.join(", ")).forEach(a=>{a.dispatchEvent(new Event(r()?"online":"offline")),a.setAttribute("data-offline-disabled",r()?"false":"true"),a.tagName==="BUTTON"?r()?a.classList.remove("disabled"):a.classList.add("disabled"):r()?a.removeAttribute("disabled"):a.setAttribute("disabled","true")})},k=()=>{c=!1,l(),b.changeOpacity(i,!0),p()},$=()=>{c=!0,s(),b.timeOut(m,3e3),p()};return{init:()=>{window.addEventListener("online",$),window.addEventListener("offline",k),i=document.getElementById("offline-mode"),i.innerHTML=`
        <div class="d-flex justify-content-center mx-auto">
            <div class="d-flex justify-content-center align-items-center rounded-pill my-2 bg-danger shadow">
                <small class="text-center py-1 px-2 mx-1 mt-1 mb-0 text-white" style="font-size: 0.8rem;"></small>
            </div>
        </div>`},isOnline:r}})();var q=(()=>{let i="gifs",c="default",f={128:2,256:3,512:4,768:5},r=null,l=null,s=null,m=null,p=async t=>{if(r.has(t))return r.get(t);let g=(C,M=3,L=1e3)=>z(G,t).default().then(N=>N.blob().then(j=>C.put(t,new Response(j,{headers:new Headers(N.headers)})).then(()=>j))).catch(N=>{if(M<=0)throw N;return console.warn("Retrying fetch:"+t),new Promise((j,W)=>b.timeOut(()=>g(C,M-1,L+1e3).then(j,W),L))}),S=C=>C.match(t).then(M=>{if(!M)return g(C);let L=M.headers.get("expires"),N=L?new Date(L).getTime():0;return Date.now()>N?C.delete(t).then(j=>j?g(C):M.blob()):M.blob()});return await caches.open(i).then(C=>S(C)).then(C=>URL.createObjectURL(C)).then(C=>(r.set(t,C),C))},k=async(t,g)=>{let{id:S,media_formats:{tinygif:{url:O}},content_description:C}=g;t.pointer===-1||t.pointer===t.col-1?t.pointer=0:t.pointer++;let M=0;for(let L of t.lists.childNodes){if(M===t.pointer){await p(O).then(N=>{L.insertAdjacentHTML("beforeend",`
                    <figure class="gif-figure m-0 position-relative">
                        <button onclick="undangan.comment.gif.click('${t.uuid}', '${S}', '${b.base64Encode(O)}')" class="btn gif-checklist position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-1 m-1 rounded-circle border shadow-sm z-1">
                            <i class="fa-solid fa-circle-check"></i>
                        </button>
                        <img src="${N}" class="img-fluid" alt="${b.escapeHtml(C)}" style="width: 100%;">
                    </figure>`)});return}M++}},$=t=>{let g=t.lists,S=document.getElementById(`gif-loading-${t.uuid}`),O=document.getElementById(`progress-bar-${t.uuid}`),C=document.getElementById(`progress-info-${t.uuid}`),M=0,L=0;return g.classList.contains("d-none")||S.classList.replace("d-none","d-flex"),C.innerText=`${L}/${M}`,g.setAttribute("data-continue","false"),g.classList.replace("overflow-y-scroll","overflow-y-hidden"),{release:()=>{g.classList.contains("d-none")||S.classList.replace("d-flex","d-none"),O.style.width="0%",C.innerText=`${L}/${M}`,g.setAttribute("data-continue","true"),g.classList.replace("overflow-y-hidden","overflow-y-scroll")},until:K=>{M=K,C.innerText=`${L}/${M}`},step:()=>{L+=1,C.innerText=`${L}/${M}`,O.style.width=Math.min(L/M*100,100).toString()+"%"}}},A=(t,g,S)=>{S={media_filter:"tinygif",client_key:"undangan_app",key:m.get("tenor_key"),country:X.getCountry(),locale:X.getLocale(),...S??{}};let O=Object.keys(S).filter(L=>S[L]!==null&&S[L]!==void 0).map(L=>`${L}=${encodeURIComponent(S[L])}`).join("&"),C=`https://tenor.googleapis.com/v2${g}?${O}`,M=new Promise(L=>{t.reqs.push(L)});t.last=new Promise(L=>{let N=!0;(async()=>(await M,N=!1))(),(async()=>{let j=$(t);try{let W=await z(G,C).withCancel(M).default(Z).then(K=>K.json()).then(K=>{if(!K.error)return K;throw new Error(K.error.message)});if(W.results.length>0){t.next=W?.next,j.until(W.results.length);for(let K of W.results)try{N&&(t.gifs.push(K),await k(t,K),j.step())}catch(he){throw N=!1,he}}}catch(W){N=!1,W.name==="AbortError"?console.warn("Fetch abort:",W):alert(W)}finally{j.release(),L()}})()})},a=t=>`
        <label for="gif-search-${t}" class="form-label my-1"><i class="fa-solid fa-photo-film me-2"></i>Gif</label>

        <div class="d-flex mb-3" id="gif-search-nav-${t}">
            <button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1" onclick="undangan.comment.gif.back(this, '${t}')" data-offline-disabled="false"><i class="fa-solid fa-arrow-left"></i></button>
            <input type="text" name="gif-search" id="gif-search-${t}" autocomplete="on" class="form-control shadow-sm rounded-4" placeholder="Search for a GIF on Tenor" data-offline-disabled="false">
        </div>

        <div class="position-relative">
            <div class="position-absolute d-flex flex-column justify-content-center align-items-center top-50 start-50 translate-middle w-100 h-100 bg-overlay-auto rounded-4 z-3" id="gif-loading-${t}">
                <div class="progress w-25" role="progressbar" style="height: 0.5rem;" aria-label="progress bar">
                    <div class="progress-bar" id="progress-bar-${t}" style="width: 0%"></div>
                </div>
                <small class="mt-1 text-theme-auto bg-theme-auto py-0 px-2 rounded-4" id="progress-info-${t}" style="font-size: 0.7rem;"></small>
            </div>
            <div id="gif-lists-${t}" class="d-flex rounded-4 p-0 overflow-y-scroll border" data-continue="true" style="height: 15rem;"></div>
        </div>

        <figure class="d-flex m-0 position-relative" id="gif-result-${t}">
            <button onclick="undangan.comment.gif.cancel('${t}')" id="gif-cancel-${t}" class="btn d-none position-absolute justify-content-center align-items-center top-0 end-0 bg-overlay-auto p-2 m-1 rounded-circle border shadow-sm z-1">
                <i class="fa-solid fa-circle-xmark"></i>
            </button>
        </figure>`,y=async t=>{t.reqs.forEach(g=>g()),t.reqs=[],t.last&&(await t.last,t.last=null)},o=async t=>{await y(t);let g=0;for(let[O,C]of Object.entries(f))g=C,t.lists.clientWidth>=parseInt(O)&&(t.col=g);if(t.col===null&&(t.col=g),t.pointer=-1,t.limit=t.col*5,t.lists.innerHTML='<div class="d-flex flex-column"></div>'.repeat(t.col),t.gifs.length===0)return;let S=$(t);S.until(t.gifs.length);for(let O of t.gifs)try{await k(t,O),S.step()}catch{t.gifs=[];break}S.release(),t.gifs.length===0&&await o(t)},u=async t=>{if(t.lists.getAttribute("data-continue")!=="true"||!t.next||t.next.length===0)return;let g=t.query&&t.query.trim().length>0,S={pos:t.next,limit:t.limit};g&&(S.q=t.query),t.lists.scrollTop>(t.lists.scrollHeight-t.lists.clientHeight)*.9&&(await y(t),A(t,g?"/search":"/featured",S))},v=async(t,g=null)=>{t.query=g!==null?g:t.query,(!t.query||t.query.trim().length===0)&&(t.query=null),t.next=null,t.gifs=[],t.pointer=-1,await o(t),A(t,t.query===null?"/featured":"/search",{q:t.query,limit:t.limit})},T=t=>{if(!l.has(t)){document.getElementById(`gif-form-${t}`).innerHTML=a(t),l.set(t,{uuid:t,last:null,limit:null,query:null,next:null,col:null,pointer:-1,gifs:[],reqs:[],lists:document.getElementById(`gif-lists-${t}`)});let g=l.get(t),S=b.debounce(o,750),O=b.debounce(v,750),C=b.debounce(u,250);window.addEventListener("resize",()=>S(g)),g.lists.addEventListener("scroll",()=>C(g)),document.getElementById(`gif-search-${t}`).addEventListener("input",M=>O(g,M.target.value))}return l.get(t)};return{default:c,init:()=>{r=new Map,s=new Map,l=new Map,m=H("config"),m.get("tenor_key")===null&&document.querySelector('[onclick="undangan.comment.gif.open(undangan.comment.gif.default)"]')?.remove()},cache:p,back:async(t,g)=>{let S=b.disableButton(t,b.loader.replace("me-1","me-0"),!0);await y(l.get(g)),S.restore(),document.getElementById(`gif-form-${g}`).classList.toggle("d-none",!0),document.getElementById(`comment-form-${g}`)?.classList.toggle("d-none",!1)},open:async t=>{let g=T(t);document.getElementById(`gif-form-${t}`).classList.toggle("d-none",!1),document.getElementById(`comment-form-${t}`)?.classList.toggle("d-none",!0),s.has(t)&&s.get(t)(),await v(g)},cancel:t=>{let g=document.getElementById(`gif-result-${t}`);g.removeAttribute("data-id"),g.querySelector(`#gif-cancel-${t}`).classList.replace("d-flex","d-none"),g.querySelector("img").remove(),l.get(t).lists.classList.replace("d-none","d-flex"),document.getElementById(`gif-search-nav-${t}`).classList.replace("d-none","d-flex")},click:(t,g,S)=>{let O=document.getElementById(`gif-result-${t}`);O.setAttribute("data-id",g),O.querySelector(`#gif-cancel-${t}`).classList.replace("d-none","d-flex"),O.insertAdjacentHTML("beforeend",`<img src="${r.get(b.base64Decode(S))}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">`),l.get(t).lists.classList.replace("d-flex","d-none"),document.getElementById(`gif-search-nav-${t}`).classList.replace("d-flex","d-none")},remove:async(t=null)=>{t?l.has(t)&&(await y(l.get(t)),l.delete(t),s.delete(t)):(await Promise.all(Array.from(l.keys()).map(g=>y(l.get(g)))),l.clear(),s.clear())},isOpen:t=>{let g=document.getElementById(`gif-form-${t}`);return g===null?!1:!g.classList.contains("d-none")},onOpen:(t,g)=>s.set(t,g),getResultId:t=>document.getElementById(`gif-result-${t}`)?.getAttribute("data-id"),buttonCancel:(t=null)=>{let g=document.getElementById(`gif-cancel-${t||c}`);return{show:()=>g.classList.replace("d-none","d-flex"),hide:()=>g.classList.replace("d-flex","d-none"),click:()=>g.dispatchEvent(new Event("click"))}},removeGifSearch:t=>document.querySelector(`[for="gif-search-${t}"]`)?.remove(),removeButtonBack:t=>document.querySelector(`[onclick="undangan.comment.gif.back(this, '${t}')"]`)?.remove()}})();var V=(()=>{let i=null,c=null,f=null,r=null,l=null,s=null,m=300,p=[["*",'<strong class="text-theme-auto">$1</strong>'],["_",'<em class="text-theme-auto">$1</em>'],["~",'<del class="text-theme-auto">$1</del>'],["```",'<code class="font-monospace text-theme-auto">$1</code>']],k=()=>`
        <div class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4">
            <div class="d-flex justify-content-between align-items-center placeholder-wave">
                <span class="placeholder bg-secondary col-5 rounded-3 my-1"></span>
                <span class="placeholder bg-secondary col-3 rounded-3 my-1"></span>
            </div>
            <hr class="my-1">
            <p class="placeholder-wave m-0">
                <span class="placeholder bg-secondary col-6 rounded-3"></span>
                <span class="placeholder bg-secondary col-5 rounded-3"></span>
                <span class="placeholder bg-secondary col-12 rounded-3 my-1"></span>
            </p>
        </div>`,$=e=>(p.forEach(n=>{let d=n[0],h=n[1];e=e.replace(new RegExp(`\\${d}(?=\\S)(.*?)(?<!\\s)\\${d}`,"gs"),h)}),e),A=e=>`
        <button style="font-size: 0.8rem;" onclick="undangan.comment.like.love(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto ms-auto rounded-3 p-0 shadow-sm d-flex justify-content-start align-items-center" data-offline-disabled="false">
            <span class="my-0 mx-1" data-count-like="${e.like.love}">${e.like.love}</span>
            <i class="me-1 ${f.has(e.uuid)?"fa-solid fa-heart text-danger":"fa-regular fa-heart"}"></i>
        </button>`,a=e=>{let n=`<div class="d-flex justify-content-start align-items-center" data-button-action="${e.uuid}">`;return(r.get("can_reply")===!0||r.get("can_reply")===void 0)&&(n+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.reply(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Reply</button>`),c.has(e.uuid)&&(r.get("can_edit")===!0||r.get("can_edit")===void 0)&&!(e.gif_url&&r.get("tenor_key")===null)&&(n+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.edit(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Edit</button>`),P.isAdmin()?n+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-own="${e.own}" data-offline-disabled="false">Delete</button>`:c.has(e.uuid)&&(r.get("can_delete")===!0||r.get("can_delete")===void 0)&&(n+=`<button style="font-size: 0.8rem;" onclick="undangan.comment.remove(this)" data-uuid="${e.uuid}" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1 shadow-sm" data-offline-disabled="false">Delete</button>`),n+="</div>",n},y=(e,n)=>{let d=s.get("show").includes(e);return`<a class="text-theme-auto" style="font-size: 0.8rem;" onclick="undangan.comment.showOrHide(this)" data-uuid="${e}" data-uuids="${n.join(",")}" data-show="${d?"true":"false"}" role="button" class="me-auto ms-1 py-0">${d?"Hide replies":`Show replies (${n.length})`}</a>`},o=e=>`
        <div class="d-flex justify-content-between align-items-center" id="button-${e.uuid}">
            ${a(e)}
            ${e.comments.length>0?y(e.uuid,e.comments.map(n=>n.uuid)):""}
            ${A(e)}
        </div>`,u=e=>e.ip===void 0||e.user_agent===void 0||e.is_admin?"":`
        <div class="mb-1 mt-3">
            <p class="text-theme-auto mb-1 mx-0 mt-0 p-0" style="font-size: 0.7rem;" id="ip-${e.uuid}"><i class="fa-solid fa-location-dot me-1"></i>${b.escapeHtml(e.ip)} ${l.has(e.ip)?`<strong>${l.get(e.ip)}</strong>`:'<span class="mb-1 placeholder col-2 rounded-3"></span>'}</p>
            <p class="text-theme-auto m-0 p-0" style="font-size: 0.7rem;"><i class="fa-solid fa-mobile-screen-button me-1"></i>${b.parseUserAgent(b.escapeHtml(e.user_agent))}</p>
        </div>`,v=(e,n)=>n?'class="bg-theme-auto shadow p-3 mx-0 mt-0 mb-3 rounded-4" data-parent="true"':`class="${s.get("hidden").find(d=>d.uuid===e.uuid).show?"":"d-none"} overflow-x-scroll mw-100 border-start bg-theme-auto py-2 ps-2 pe-0 my-2 ms-2 me-0"`,T=(e,n)=>e.is_admin?`<strong class="me-1">${b.escapeHtml(i.get("name")??r.get("name"))}</strong><i class="fa-solid fa-certificate text-primary"></i>`:n?`<strong class="me-1">${b.escapeHtml(e.name)}</strong><i id="badge-${e.uuid}" data-is-presence="${e.presence?"true":"false"}" class="fa-solid ${e.presence?"fa-circle-check text-success":"fa-circle-xmark text-danger"}"></i>`:`<strong>${b.escapeHtml(e.name)}</strong>`,w=async(e,n)=>{let d=`
        <div class="d-flex justify-content-between align-items-center">
            <p class="text-theme-auto text-truncate m-0 p-0" style="font-size: 0.95rem;">${T(e,n)}</p>
            <small class="text-theme-auto m-0 p-0" style="font-size: 0.75rem;">${e.created_at}</small>
        </div>
        <hr class="my-1">`;if(e.gif_url)return d+`
            <div class="d-flex justify-content-center align-items-center my-2">
                <img src="${await q.cache(e.gif_url)}" id="img-gif-${e.uuid}" class="img-fluid mx-auto gif-image rounded-4" alt="selected-gif">
            </div>`;let h=$(b.escapeHtml(e.comment)),x=h.length>m;return d+`
        <p class="text-theme-auto my-1 mx-0 p-0" style="white-space: pre-wrap !important; font-size: 0.95rem;" ${x?`data-comment="${b.base64Encode(h)}"`:""} id="content-${e.uuid}">${x?h.slice(0,m)+"...":h}</p>
        ${x?`<p class="d-block mb-2 mt-0 mx-0 p-0"><a class="text-theme-auto" role="button" style="font-size: 0.85rem;" data-show="false" onclick="undangan.comment.showMore(this, '${e.uuid}')">Selengkapnya</a></p>`:""}`},B=async(e,n)=>{let d=await w(e,n),h="";for(let x of e.comments)h+=await B(x,!1);return`
        <div ${v(e,n)} id="${e.uuid}" style="overflow-wrap: break-word !important;">
            <div id="body-content-${e.uuid}" data-tapTime="0" data-liked="false" tabindex="0">${d}</div>
            ${u(e)}
            ${o(e)}
            <div id="reply-content-${e.uuid}">${h}</div>
        </div>`};return{init:()=>{i=H("user"),c=H("owns"),f=H("likes"),r=H("config"),l=H("tracker"),s=H("comment")},renderEdit:(e,n,d,h)=>{let x=document.createElement("div");return x.classList.add("my-2"),x.id=`inner-${e}`,x.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-pen me-2"></i>Edit</p>
        ${d?`
        <select class="form-select shadow-sm mb-2 rounded-4" id="form-inner-presence-${e}" data-offline-disabled="false">
            <option value="1" ${n?"selected":""}>&#9989; Datang</option>
            <option value="2" ${n?"":"selected"}>&#10060; Berhalangan</option>
        </select>`:""}
        ${h?`${r.get("tenor_key")===null?"":`<div class="d-none mb-2" id="gif-form-${e}"></div>`}`:`<textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type update comment" rows="3" data-offline-disabled="false"></textarea>    
        `}
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel(this, '${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.update(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Update</button>
        </div>`,x},renderReply:e=>{let n=document.createElement("div");return n.classList.add("my-2"),n.id=`inner-${e}`,n.innerHTML=`
        <p class="my-1 mx-0 p-0" style="font-size: 0.95rem;"><i class="fa-solid fa-reply me-2"></i>Reply</p>
        <div class="d-block mb-2" id="comment-form-${e}">
            <div class="position-relative">
                ${r.get("tenor_key")===null?"":`<button class="btn btn-secondary btn-sm rounded-4 shadow-sm me-1 my-1 position-absolute bottom-0 end-0" onclick="undangan.comment.gif.open('${e}')" aria-label="button gif" data-offline-disabled="false"><i class="fa-solid fa-photo-film"></i></button>`}
                <textarea class="form-control shadow-sm rounded-4 mb-2" id="form-inner-${e}" minlength="1" maxlength="1000" placeholder="Type reply comment" rows="3" data-offline-disabled="false"></textarea>
            </div>
        </div>
        <div class="d-none mb-2" id="gif-form-${e}"></div>
        <div class="d-flex justify-content-end align-items-center mb-0">
            <button style="font-size: 0.8rem;" onclick="undangan.comment.cancel(this, '${e}')" class="btn btn-sm btn-outline-auto rounded-4 py-0 me-1" data-offline-disabled="false">Cancel</button>
            <button style="font-size: 0.8rem;" onclick="undangan.comment.send(this)" data-uuid="${e}" class="btn btn-sm btn-outline-auto rounded-4 py-0" data-offline-disabled="false">Send</button>
        </div>`,n},renderLoading:k,renderReadMore:y,renderInnerContent:e=>B(e,!1),renderContent:e=>B(e,!0),convertMarkdownToHTML:$,maxCommentLength:m}})();var me=()=>window.confetti.shapeFromPath({path:"M167 72c19,-38 37,-56 75,-56 42,0 76,33 76,75 0,76 -76,151 -151,227 -76,-76 -151,-151 -151,-227 0,-42 33,-75 75,-75 38,0 57,18 76,56z",matrix:[.03333333333333333,0,0,.03333333333333333,-5.566666666666666,-5.533333333333333]}),ue=()=>{window.confetti({origin:{y:1},zIndex:1057})},fe=(i=15)=>{let c=i*1e3,f=Date.now()+c,r=me(),l=["#FFC0CB","#FF1493","#C71585"],s=(p,k)=>Math.random()*(k-p)+p,m=()=>{let p=f-Date.now();l.forEach(k=>{window.confetti({particleCount:1,startVelocity:0,ticks:Math.max(50,75*(p/c)),origin:{x:Math.random(),y:Math.abs(Math.random()-p/c)},zIndex:1057,colors:[k],shapes:[r],drift:s(-.5,.5),gravity:s(.5,1),scalar:s(.5,1)})}),p>0&&requestAnimationFrame(m)};requestAnimationFrame(m)},ge=i=>{if(!window.confetti)return;let c=Date.now()+25,f=Math.max(.3,Math.min(1,i.getBoundingClientRect().top/window.innerHeight+.2)),r=me(),l=["#FF69B4","#FF1493"],s=()=>{l.forEach(m=>{window.confetti({particleCount:2,angle:60,spread:55,shapes:[r],origin:{x:0,y:f},zIndex:1057,colors:[m]}),window.confetti({particleCount:2,angle:120,spread:55,shapes:[r],origin:{x:1,y:f},zIndex:1057,colors:[m]})}),Date.now()<c&&requestAnimationFrame(s)};requestAnimationFrame(s)};var ee=(()=>{let i=null,c=async s=>{let m=s.firstElementChild,p=s.lastElementChild,k=s.getAttribute("data-uuid"),$=parseInt(m.getAttribute("data-count-like"));s.disabled=!0,navigator.vibrate&&navigator.vibrate(100),i.has(k)?await z(re,"/api/comment/"+i.get(k)).token(P.getToken()).send(F.statusResponse).then(A=>{A.data.status&&(i.unset(k),p.classList.remove("fa-solid","text-danger"),p.classList.add("fa-regular"),m.setAttribute("data-count-like",String($-1)))}):await z(Q,"/api/comment/"+k).token(P.getToken()).send(F.uuidResponse).then(A=>{A.code===ne&&(i.set(k,A.data.uuid),p.classList.remove("fa-regular"),p.classList.add("fa-solid","text-danger"),m.setAttribute("data-count-like",String($+1)))}),m.innerText=m.getAttribute("data-count-like"),s.disabled=!1},f=s=>document.querySelector(`button[onclick="undangan.comment.like.love(this)"][data-uuid="${s}"]`);return{init:()=>{i=H("likes")},love:c,tapTap:async s=>{if(!navigator.onLine)return;let m=Date.now(),p=m-parseInt(s.getAttribute("data-tapTime")),k=s.id.replace("body-content-",""),$=p<300&&p>0,A=!i.has(k)&&s.getAttribute("data-liked")!=="true";$&&A&&(ge(s),s.setAttribute("data-liked","true"),await c(f(k)),s.setAttribute("data-liked","false")),s.setAttribute("data-tapTime",m)},getButtonLike:f}})();var J=(()=>{let i=10,c=0,f=0,r=null,l=null,s=null,m=null,p=null,k=E=>{i=Number(E)},$=()=>i,A=()=>c,a=()=>f,y=()=>l.classList.contains("disabled")?null:l.classList.add("disabled"),o=()=>l.classList.contains("disabled")?l.classList.remove("disabled"):null,u=()=>s.classList.contains("disabled")?null:s.classList.add("disabled"),v=()=>s.classList.contains("disabled")?s.classList.remove("disabled"):null,T=E=>{u(),y();let _=b.disableButton(E,b.loader.replace("ms-0 me-1","mx-1"),!0),e=async()=>{let h=new Promise(x=>p.addEventListener("comment.result",x,{once:!0}));p.dispatchEvent(new Event("comment.show")),await h,_.restore(),p.scrollIntoView({behavior:"smooth"})};return{next:()=>{c+=i,E.innerHTML="Next"+E.innerHTML,e()},prev:()=>{c-=i,E.innerHTML=E.innerHTML+"Prev",e()}}};return{init:()=>{m=document.getElementById("pagination"),m.innerHTML=`
        <ul class="pagination mb-2 shadow-sm rounded-4">
            <li class="page-item disabled" id="previous">
                <button class="page-link rounded-start-4" onclick="undangan.comment.pagination.previous(this)" data-offline-disabled="false">
                    <i class="fa-solid fa-circle-left me-1"></i>Prev
                </button>
            </li>
            <li class="page-item disabled">
                <span class="page-link text-theme-auto" id="page"></span>
            </li>
            <li class="page-item" id="next">
                <button class="page-link rounded-end-4" onclick="undangan.comment.pagination.next(this)" data-offline-disabled="false">
                    Next<i class="fa-solid fa-circle-right ms-1"></i>
                </button>
            </li>
        </ul>`,p=document.getElementById("comments"),r=document.getElementById("page"),l=document.getElementById("previous"),s=document.getElementById("next")},setPer:k,getPer:$,getNext:A,reset:()=>c===0?!1:(c=0,u(),y(),!0),setTotal:E=>{if(f=Number(E),f===0||f<=i&&c===0){m.classList.add("d-none");return}let _=c/i+1,e=Math.ceil(f/i);if(r.innerText=`${_} / ${e}`,c>0&&o(),_>=e){u();return}v(),m.classList.contains("d-none")&&m.classList.remove("d-none")},geTotal:a,previous:E=>T(E).prev(),next:E=>T(E).next()}})();var se=(()=>{let i=null,c=null,f=null,r=null,l=null,s=[],m=()=>`<div class="text-center p-4 mx-0 mt-0 mb-3 bg-theme-auto rounded-4 shadow"><p class="fw-bold p-0 m-0" style="font-size: 0.95rem;">${X.on("id","\u{1F4E2} Yuk, share undangan ini biar makin rame komentarnya! \u{1F389}").on("en","\u{1F4E2} Let's share this invitation to get more comments! \u{1F389}").get()}</p></div>`,p=(e,n)=>{document.querySelector(`[data-button-action="${e}"]`).childNodes.forEach(d=>{d.disabled=n})},k=e=>{p(e,!1),document.getElementById(`inner-${e}`).remove()},$=e=>{e.comments&&e.comments.forEach($);let n=document.getElementById(`body-content-${e.uuid}`);n.addEventListener("touchend",()=>ee.tapTap(n))},A=e=>{let n=e.getAttribute("data-uuids").split(","),d=e.getAttribute("data-show")==="true",h=e.getAttribute("data-uuid");d?(e.setAttribute("data-show","false"),e.innerText=`Show replies (${n.length})`,r.set("show",r.get("show").filter(x=>x!==h))):(e.setAttribute("data-show","true"),e.innerText="Hide replies",r.set("show",r.get("show").concat([h])));for(let x of n){r.set("hidden",r.get("hidden").map(D=>(D.uuid===x&&(D.show=!d),D)));let R=document.getElementById(x).classList;d?R.add("d-none"):R.remove("d-none")}},a=(e,n)=>{let d=document.getElementById(`content-${n}`),h=b.base64Decode(d.getAttribute("data-comment")),x=e.getAttribute("data-show")==="false";d.innerHTML=x?h:h.slice(0,V.maxCommentLength)+"...",e.innerText=x?"Sebagian":"Selengkapnya",e.setAttribute("data-show",x?"true":"false")},y=e=>{if(!P.isAdmin()||(e.comments&&e.comments.forEach(y),e.ip===void 0||e.user_agent===void 0||e.is_admin||f.has(e.ip)))return;let n=(d,h,x)=>{document.getElementById(`ip-${d}`).innerHTML=`<i class="fa-solid fa-location-dot me-1"></i>${b.escapeHtml(h)} <strong>${b.escapeHtml(x)}</strong>`};z(G,`https://freeipapi.com/api/json/${e.ip}`).default(Z).then(d=>d.json()).then(d=>{let h=d.cityName+" - "+d.regionName;d.cityName==="-"&&d.regionName==="-"&&(h="localhost"),f.set(e.ip,h),n(e.uuid,e.ip,h)}).catch(d=>n(e.uuid,e.ip,d.message))},o=(e,n=[])=>(e.forEach(d=>{n.find(h=>h.uuid===d.uuid)||n.push(F.commentShowMore(d.uuid)),d.comments&&d.comments.length>0&&o(d.comments,n)}),n),u=()=>(l.getAttribute("data-loading")==="false"&&(l.setAttribute("data-loading","true"),l.innerHTML=V.renderLoading().repeat(J.getPer())),z(G,`/api/v2/comment?per=${J.getPer()}&next=${J.getNext()}&lang=${X.getLanguage()}`).token(P.getToken()).send(F.getCommentsResponseV2).then(async e=>{l.setAttribute("data-loading","false");for(let d of s)await q.remove(d);if(e.data.lists.length===0)return l.innerHTML=m(),e;s=o(e.data.lists).map(d=>d.uuid),r.set("hidden",o(e.data.lists,r.get("hidden")));let n="";for(let d of e.data.lists)n+=await V.renderContent(d);return e.data.lists.length<J.getPer()&&(n+=m()),l.innerHTML=n,e.data.lists.forEach(y),e.data.lists.forEach($),e}).then(e=>(J.setTotal(e.data.count),l.dispatchEvent(new Event("comment.result")),e)));return{gif:q,like:ee,pagination:J,init:()=>{q.init(),ee.init(),V.init(),J.init(),l=document.getElementById("comments"),l.addEventListener("comment.show",u),i=H("owns"),c=H("user"),f=H("tracker"),r=H("comment"),r.has("hidden")||r.set("hidden",[]),r.has("show")||r.set("show",[])},send:async e=>{let n=e.getAttribute("data-uuid"),d=document.getElementById("form-name"),h=d.value;if(P.isAdmin()&&(h=c.get("name")),h.length===0){alert("Name cannot be empty."),n&&document.getElementById("comment").scrollIntoView({behavior:"smooth"});return}let x=document.getElementById("form-presence");if(!n&&x&&x.value==="0"){alert("Please select your attendance status.");return}let R=q.isOpen(n||q.default),D=q.getResultId(n||q.default),t=q.buttonCancel(n);if(R&&!D){alert("Gif cannot be empty.");return}R&&D&&t.hide();let g=document.getElementById(`form-${n?`inner-${n}`:"comment"}`);if(!R&&g.value.length===0){alert("Comments cannot be empty.");return}!n&&d&&!P.isAdmin()&&(d.disabled=!0),!P.isAdmin()&&x&&x.value!=="0"&&(x.disabled=!0),g&&(g.disabled=!0);let S=document.querySelector(`[onclick="undangan.comment.cancel(this, '${n}')"]`);S&&(S.disabled=!0);let O=b.disableButton(e),C=x?x.value==="1":!0;if(!P.isAdmin()){let L=H("information");L.set("name",h),n||L.set("presence",C)}let M=await z(Q,`/api/comment?lang=${X.getLanguage()}`).token(P.getToken()).body(F.postCommentRequest(n,h,C,R?null:g.value,D)).send(F.getCommentResponse).then(L=>L,()=>null);if(d&&(d.disabled=!1),g&&(g.disabled=!1),S&&(S.disabled=!1),x&&(x.disabled=!1),R&&D&&t.show(),O.restore(),!(!M||M.code!==ne)){if(i.set(M.data.uuid,M.data.own),g&&(g.value=null),R&&D&&t.click(),!n){if(J.reset()){await u(),l.scrollIntoView({behavior:"smooth"});return}J.setTotal(J.geTotal()+1),l.children.length===J.getPer()&&l.lastElementChild.remove(),M.data.is_admin=P.isAdmin();let L=await V.renderContent(M.data);l.insertAdjacentHTML("afterbegin",L),l.scrollIntoView({behavior:"smooth"})}if(n){r.set("hidden",r.get("hidden").concat([F.commentShowMore(M.data.uuid,!0)])),r.set("show",r.get("show").concat([n])),k(n),M.data.is_admin=P.isAdmin(),document.getElementById(`reply-content-${n}`).insertAdjacentHTML("beforeend",await V.renderInnerContent(M.data));let L=document.getElementById(`button-${n}`).querySelector("a"),N=[M.data.uuid];L&&(L.getAttribute("data-show")==="false"&&A(L),L.remove()),ee.getButtonLike(n).insertAdjacentHTML("beforebegin",V.renderReadMore(n,L?L.getAttribute("data-uuids").split(",").concat(N):N))}$(M.data)}},edit:async e=>{let n=e.getAttribute("data-uuid");if(document.getElementById(`inner-${n}`))return;p(n,!0);let d=b.disableButton(e);await z(G,"/api/comment/"+n).token(P.getToken()).send(F.commentResponse).then(async h=>{if(h.code!==Y)return h;h.data.gif_url&&await q.remove(n);let x=document.getElementById(n).getAttribute("data-parent")==="true"&&!P.isAdmin();if(document.getElementById(`button-${n}`).insertAdjacentElement("afterend",V.renderEdit(n,h.data.presence,x,!!h.data.gif_url)),h.data.gif_url)return q.onOpen(n,()=>{q.removeGifSearch(n),q.removeButtonBack(n)}),q.open(n);let R=document.getElementById(`form-inner-${n}`);return R.value=h.data.comment,R.setAttribute("data-original",b.base64Encode(h.data.comment)),h}),d.restore(!0)},reply:async e=>{let n=e.getAttribute("data-uuid");if(document.getElementById(`inner-${n}`))return;p(n,!0);let d=b.disableButton(e);await q.remove(n),q.onOpen(n,()=>q.removeGifSearch(n)),d.restore(!0),document.getElementById(`button-${n}`).insertAdjacentElement("afterend",V.renderReply(n))},remove:async e=>{if(!confirm("Are you sure?"))return;let n=e.getAttribute("data-uuid");P.isAdmin()&&i.set(n,e.getAttribute("data-own")),p(n,!0);let d=b.disableButton(e),h=ee.getButtonLike(n);if(h.disabled=!0,!await z(le,"/api/comment/"+i.get(n)).token(P.getToken()).send(F.statusResponse).then(R=>R.data.status,()=>!1)){d.restore(),h.disabled=!1;return}document.querySelectorAll('a[onclick="undangan.comment.showOrHide(this)"]').forEach(R=>{let D=R.getAttribute("data-uuids").split(",");if(D.find(t=>t===n)){let t=D.filter(g=>g!==n).join(",");t.length===0?R.remove():R.setAttribute("data-uuids",t)}}),i.unset(n),document.getElementById(n).remove(),l.children.length===0&&(l.innerHTML=m())},update:async e=>{let n=e.getAttribute("data-uuid"),d=!1,h=document.getElementById(`form-inner-presence-${n}`);h&&(h.disabled=!0,d=h.value==="1");let x=!1,R=document.getElementById(`badge-${n}`);R&&(x=R.getAttribute("data-is-presence")==="true");let D=q.isOpen(n),t=q.getResultId(n),g=q.buttonCancel(n);D&&t&&g.hide();let S=document.getElementById(`form-inner-${n}`);if(n&&!D&&b.base64Encode(S.value)===S.getAttribute("data-original")&&x===d){k(n);return}S&&(S.disabled=!0);let O=document.querySelector(`[onclick="undangan.comment.cancel(this, '${n}')"]`);O&&(O.disabled=!0);let C=b.disableButton(e),M=await z(ie,`/api/comment/${i.get(n)}?lang=${X.getLanguage()}`).token(P.getToken()).body(F.updateCommentRequest(h?d:null,D?null:S.value,t)).send(F.statusResponse).then(L=>L.data.status,()=>!1);if(S&&(S.disabled=!1),O&&(O.disabled=!1),h&&(h.disabled=!1),C.restore(),D&&t&&g.show(),!!M){if(D&&t&&(document.getElementById(`img-gif-${n}`).src=document.getElementById(`gif-result-${n}`)?.querySelector("img").src,g.click()),k(n),!D){let L=document.querySelector(`[onclick="undangan.comment.showMore(this, '${n}')"]`),N=V.convertMarkdownToHTML(b.escapeHtml(S.value)),j=document.getElementById(`content-${n}`);N.length>V.maxCommentLength?(j.innerHTML=L?.getAttribute("data-show")==="false"?N.slice(0,V.maxCommentLength)+"...":N,j.setAttribute("data-comment",b.base64Encode(N)),L?.classList.replace("d-none","d-block")):(j.innerHTML=N,j.removeAttribute("data-comment"),L?.classList.replace("d-block","d-none"))}h&&(document.getElementById("form-presence").value=d?"1":"2",H("information").set("presence",d)),!(!h||!R)&&(R.classList.toggle("fa-circle-xmark",!d),R.classList.toggle("text-danger",!d),R.classList.toggle("fa-circle-check",d),R.classList.toggle("text-success",d))}},cancel:async(e,n)=>{let d=document.getElementById(`form-inner-presence-${n}`),h=d?d.value==="1":!1,x=document.getElementById(`badge-${n}`),R=x&&i.has(n)&&d?x.getAttribute("data-is-presence")==="true":!1;if(b.disableButton(e),q.isOpen(n)&&(!q.getResultId(n)&&R===h||confirm("Are you sure?"))){await q.remove(n),k(n);return}let D=document.getElementById(`form-inner-${n}`);(D.value.length===0||b.base64Encode(D.value)===D.getAttribute("data-original")&&R===h||confirm("Are you sure?"))&&k(n)},show:u,showMore:a,showOrHide:A}})();var pe=(()=>{let i=null,c=()=>{let o=document.getElementById("count-down")?.getAttribute("data-time")?.replace(" ","T");if(!o){alert("Invalid countdown date.");return}let u=new Date(o).getTime(),v=()=>{let T=Math.abs(u-Date.now());document.getElementById("day").innerText=Math.floor(T/(1e3*60*60*24)).toString(),document.getElementById("hour").innerText=Math.floor(T%(1e3*60*60*24)/(1e3*60*60)).toString(),document.getElementById("minute").innerText=Math.floor(T%(1e3*60*60)/(1e3*60)).toString(),document.getElementById("second").innerText=Math.floor(T%(1e3*60)/1e3).toString(),b.timeOut(v,1e3-Date.now()%1e3)};requestAnimationFrame(v)},f=()=>{let o=window.location.search.split("to="),u=null;if(o.length>1&&o[1].length>=1&&(u=window.decodeURIComponent(o[1])),u){let T=document.getElementById("guest-name"),w=document.createElement("div");w.classList.add("m-2"),w.innerHTML=`<small class="mt-0 mb-1 mx-0 p-0">${T?.getAttribute("data-message")}</small><p class="m-0 p-0" style="font-size: 1.5rem">${b.escapeHtml(u)}</p>`,T?.appendChild(w)}let v=document.getElementById("form-name");v&&(v.value=i.get("name")??u)},r=async()=>{let o=0,u=0,v=6e3,T=document.querySelectorAll(".slide-desktop");for(let[I,E]of T.entries())if(I===o){E.classList.add("slide-desktop-active"),await b.changeOpacity(E,!0);break}let w=async()=>{await b.changeOpacity(T[o],!1),T[o].classList.remove("slide-desktop-active"),o=(o+1)%T.length,T[o].classList.add("slide-desktop-active"),await b.changeOpacity(T[o],!0)},B=async I=>{I-u>=v&&(u=I,await w()),requestAnimationFrame(B)};b.timeOut(B,v)},l=o=>{o.disabled=!0,document.body.scrollIntoView({behavior:"instant"}),document.dispatchEvent(new Event("undangan.open")),te.isAutoMode()&&(document.getElementById("button-theme").style.display="block"),r(),oe.play(),te.spyTop(),ue(),b.timeOut(fe,1500),b.changeOpacity(document.getElementById("welcome"),!1).then(u=>u.remove())},s=o=>{let u=document.getElementById("show-modal-image");u.src=o.src,u.width=o.width,u.height=o.height,ce.modal("modal-image").show()},m=()=>i.set("info",!0),p=()=>{document.querySelectorAll(".font-arabic").forEach(o=>{o.innerHTML=String(o.innerHTML).normalize("NFC")})},k=()=>{document.querySelectorAll("svg").forEach(o=>{b.timeOut(()=>o.classList.add(o.getAttribute("data-class")),parseInt(o.getAttribute("data-time")))})},$=()=>{let o=T=>new Date(T+":00Z").toISOString().replace(/[-:]/g,"").split(".")[0],u=new URL("https://calendar.google.com/calendar/render"),v={action:"TEMPLATE",text:"The Wedding of Putri and Rasyid",dates:`${o("2025-04-27 10:00")}/${o("2025-04-27 14:00")}`,details:"Tanpa mengurangi rasa hormat, kami mengundang Anda untuk berkenan menghadiri acara pernikahan kami. Terima kasih atas perhatian dan doa restu Anda, yang menjadi kebahagiaan serta kehormatan besar bagi kami.",location:"https://maps.app.goo.gl/3ieocaZif83Fktoi6",ctz:"Asia/Jakarta"};Object.entries(v).forEach(([T,w])=>u.searchParams.set(T,w)),document.querySelector("#home button")?.addEventListener("click",()=>window.open(u,"_blank"))},A=async()=>{k(),c(),f(),p(),$(),document.getElementById("root").style.opacity="1",i.has("presence")&&(document.getElementById("form-presence").value=i.get("presence")?"1":"2"),i.get("info")&&document.getElementById("information")?.remove(),window.AOS.init(),document.body.scrollIntoView({behavior:"instant"}),await b.changeOpacity(document.getElementById("welcome"),!0),await b.changeOpacity(document.getElementById("loading"),!1).then(o=>o.remove())},a=()=>{X.init(),de.init(),U.init(),i=H("information");let o=document.body.getAttribute("data-key");if(document.addEventListener("progress.done",()=>A()),document.addEventListener("hide.bs.modal",()=>document.activeElement?.blur()),(!o||o.length<=0)&&(U.add(),ae.init().load(),oe.init(),document.getElementById("comment")?.remove(),document.querySelector('a.nav-link[href="#comment"]')?.closest("li.nav-item")?.remove()),o&&o.length>0){U.add(),U.add(),U.add();let u=ae.init();u.hasDataSrc()||u.load();let v=new URLSearchParams(window.location.search);P.setToken(v.get("k")??o),window.addEventListener("load",()=>P.guest().then(()=>{U.complete("config"),u.hasDataSrc()&&u.load(),oe.init(),se.init(),se.show().then(()=>U.complete("comment")).catch(()=>U.invalid("comment"))}).catch(()=>U.invalid("config")))}};return{init:()=>(te.init(),P.init(),P.isAdmin()&&(H("user").clear(),H("owns").clear(),H("likes").clear(),H("session").clear(),H("comment").clear(),H("tracker").clear()),window.addEventListener("DOMContentLoaded",a),{util:b,theme:te,comment:se,guest:{open:l,modal:s,closeInformation:m}})}})();(i=>{i.undangan=pe.init()})(window);})();
